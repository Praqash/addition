<!DOCTYPE html>
<html lang="en">
  <head>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.1.0/react.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.1.0/react-dom.min.js"></script>
    <div id="app"></div>
    <script src="https://unpkg.com/react@16/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <title>Test</title>
    <style>
        #app, #ans, #winner{
            text-align: center;
            font-family: 'Courier New', Courier, monospace;
        }
    </style>
  </head>
  <meta name="viewport" content="width=device-width, initial-scale=0.5">
  <body>
    
    <script type="text/babel">

      class App extends React.Component {
        constructor(props){
            super(props);
             
            this.state = {
                time: {}, 
                seconds: 0,
                score: 0,
                count: 0,
                response: "",
                num1: Math.ceil(Math.random()*100),
                num2: Math.ceil(Math.random()*100),
            };
            this.timer = 0;
            this.startTimer = this.startTimer.bind(this);
            this.countDown = this.countUp.bind(this);
        }
        render() {
                    if (this.state.score === 10) {
                        return this.renderWinnerScreen();
                    } else {
                        return this.renderStart();
                    }
                }

                renderWinnerScreen() {
                    return (
                        <div> 
                    
                    <div id="winner">Your time is! m: {this.state.time.m} s: {this.state.time.s}</div>
                    <button id = "ans" onClick={this.startTimer}>Start</button>
                    </div> 
                    );
                    }

                renderStart() {
                    return (
                        
            <div>
               
                <h2 id = "problem">{this.state.num1}+{this.state.num2}</h2>
               <input id = "ans" onKeyPress = {this.inputKeyPress}onChange= {this.updateResponse} placeholder = "Press start to begin" value = {this.state.response}/>
               <div> Score: {this.state.score}</div>
               <h2 id = "ans">m: {this.state.time.m} s: {this.state.time.s}</h2>
               <button id = "ans" onClick={this.startTimer}>Start</button>
                  
                 
            </div>
          );
        }  
           


        secondsToTime(secs){
      let hours = Math.floor(secs / (60 * 60));
  
      let divisor_for_minutes = secs % (60 * 60);
      let minutes = Math.floor(divisor_for_minutes / 60);
  
      let divisor_for_seconds = divisor_for_minutes % 60;
      let seconds = Math.ceil(divisor_for_seconds);
  
      let obj = {
        "h": hours,
        "m": minutes,
        "s": seconds
      };
      return obj;
    }
  
    componentDidMount() {
      let timeLeftVar = this.secondsToTime(this.state.seconds);
      this.setState({ time: timeLeftVar });
    }
  
    startTimer() {
      if (this.timer == 0 && this.state.seconds == 0) {
        this.timer = setInterval(this.countDown, 1000);
      }
      
      this.setState(state =>({
                seconds: -1,
                score: 0,
                num1: Math.ceil(Math.random()*100),
                num2: Math.ceil(Math.random()*100),
                response: ""
      }));

    }

  
    countUp() {
      // Remove one second, set state so a re-render happens.
      let seconds = this.state.seconds + 1;
      this.setState({
        time: this.secondsToTime(seconds),
        seconds: seconds,
      });
      
      
      
    }
  
       inputKeyPress = (event) =>{
        if(event.key==='Enter' && this.state.seconds != 0){
          const answer = parseInt(this.state.response); 
          if (answer === this.state.num1+this.state.num2)  
          {
            this.setState(state =>({
                score: state.score +1,
                num1: Math.ceil(Math.random()*100),
                num2: Math.ceil(Math.random()*100),
                response: ""
            }));
          }
          else{
              this.setState(state=>({
                score: state.score -1,
                response: ""

              }))

        }

           }
           }
           
           updateResponse = (event) => {
               this.setState({
                  response: event.target.value
               });

           } 

      }

      ReactDOM.render(<App />, document.querySelector("#app"));

    </script>
  </body>
</html>
